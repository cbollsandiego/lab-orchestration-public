{% extends 'base.html' %}
{% block content %}
    <h1>Groups for {{ course.course_name }} {{ session.name }}</h1>
    {% for group in groups %}
        <h2>{{ group.group_name }}</h2>
        <ul>
        {% for user in group.users %}
            <li>
                <a href="{{ url_for('user', user_id=user.id) }}">{{ user.name }}</a>
                {% if add_to_group_form %}
                    <form action="{{ url_for('remove_from_group', course_id=course.id, group_id=group.id, user_id=user.id) }}" method="post">
                        <input type="submit" value="Remove user from Group">
                    </form>
                {% endif %}
            </li>
        {% endfor %}
        </ul>
        {% if add_to_group_form %}
            <form action="{{ url_for('delete_group', group_id=group.id) }}" method="post">
                {{ add_to_group_form.csrf_token }}
                <input type="submit" value="Delete Group" onclick="return confirmDelete(event)">
            </form>
        {% endif %}
    {% endfor %}
    <br>
    {% if add_to_group_form %}
        <form action="" method="post" novalidate>
            {{ add_to_group_form.csrf_token }}
            {{ add_to_group_form.group.label }}
            {{ add_to_group_form.group() }}
            {{ add_to_group_form.student_to_add.label }}
            {{ add_to_group_form.student_to_add() }}
            {{ add_to_group_form.submit_add_to_group() }}
        </form>
    {% endif %}
    {% if new_group_form %}
        <h2>Create new Group</h2>
        <form action="" method="post" novalidate>
            {{ new_group_form.csrf_token }}
            {{ new_group_form.name.label }}<br>
            {{ new_group_form.name() }}
            {{ new_group_form.submit_create_group() }}
        </form>
    {% endif %}
    <script>
        function confirmDelete(event) {
            if (!confirm("Are you sure you want to delete this group?")) {
                event.preventDefault();
                return false;
            }
            return true;
        }
    </script>
{% endblock %}